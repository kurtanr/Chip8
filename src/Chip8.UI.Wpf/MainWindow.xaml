<Window x:Class="Chip8.UI.Wpf.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:chip8uiviewmodel="clr-namespace:Chip8.UI.Wpf.ViewModel"
        xmlns:chip8uiview="clr-namespace:Chip8.UI.Wpf.View"
        mc:Ignorable="d"
        Focusable="True"
        WindowStartupLocation="CenterScreen"
        Title="{Binding Title}"
        Height="600"
        MinHeight="600"
        Width="810"
        MinWidth="810"
        ThemeMode="System"
        d:DataContext="{d:DesignInstance chip8uiviewmodel:MainViewModel}">
  <Window.Resources>

    <chip8uiview:SynchronisedScrollToken x:Key="scrollToken" />

    <chip8uiview:ImageSourceConverter x:Key="ImageConverter" />

    <Style TargetType="Image">
      <Style.Triggers>
        <Trigger Property="IsEnabled" Value="False">
          <Setter Property="Opacity" Value="0.1" />
        </Trigger>
      </Style.Triggers>
    </Style>
  </Window.Resources>

  <Window.InputBindings>
    <KeyBinding Command="{Binding LoadApplicationCommand}" Key="O" Modifiers="Ctrl+Shift" />
    <KeyBinding Command="{Binding SaveApplicationCommand}" Key="S" Modifiers="Ctrl+Shift" />
    <KeyBinding Command="{Binding RunContinueApplicationCommand}" Key="F5" Modifiers="" />
    <KeyBinding Command="{Binding PauseApplicationCommand}" Key="B" Modifiers="Ctrl" />
    <KeyBinding Command="{Binding StopApplicationCommand}" Key="F5" Modifiers="Shift" />
    <KeyBinding Command="{Binding ExecuteSingleStepCommand}" Key="F10" Modifiers="" />
    <KeyBinding Command="{Binding NewSourceCodeCommand}" Key="N" Modifiers="Ctrl" />
    <KeyBinding Command="{Binding LoadSourceCodeCommand}" Key="O" Modifiers="Ctrl" />
    <KeyBinding Command="{Binding SaveSourceCodeCommand}" Key="S" Modifiers="Ctrl" />
    <KeyBinding Command="{Binding BuildSourceCodeCommand}" Key="F6" Modifiers="" />
    <KeyBinding Command="{Binding ToggleBreakpointCommand}" Key="F9" Modifiers="" />
  </Window.InputBindings>

  <Grid>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="*" />
      <ColumnDefinition Width="*" />
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
      <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>

    <Grid Grid.ColumnSpan="2">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition Width="*" />
      </Grid.ColumnDefinitions>

      <Grid Grid.Column="0"
                    x:Name="DisplayGrid"
                    Background="Black"
                    Height="320"
                    HorizontalAlignment="Left"
                    Margin="5"
                    Width="640" />
      <chip8uiview:BindableAvalonEditor xmlns:avalonEdit="http://icsharpcode.net/sharpdevelop/avalonedit"
                                   Grid.Column="1"
                                   x:Name="TextEditorCpu"
                                   Background="{Binding EditorBackground}"
                                   Foreground="{Binding EditorForeground}"
                                   FontFamily="Consolas"
                                   FontSize="10pt"
                                   HorizontalScrollBarVisibility="Disabled"
                                   IsReadOnly="True"
                                   Margin="5"
                                   SyntaxHighlighting="CHIP-8"
                                   Text="{Binding CpuRegisters}" />
    </Grid>

    <Grid Grid.ColumnSpan="2" Grid.Row="1">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" MinWidth="320" />
        <ColumnDefinition Width="5" />
        <ColumnDefinition Width="*" MinWidth="320" />
      </Grid.ColumnDefinitions>
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
      </Grid.RowDefinitions>

      <Grid Grid.Row="0" Grid.Column="0" Margin="5">
        <StackPanel Orientation="Horizontal">
          <Button ToolTip="Open Binary File (Ctrl+Shift+O)" Command="{Binding LoadApplicationCommand}" Margin="0,0,1,0">
            <Image Source="{Binding IsDarkMode, Converter={StaticResource ImageConverter}, ConverterParameter=load}" Height="25" Width="25" />
          </Button>
          <Button ToolTip="Save Binary File (Ctrl+Shift+S)" Command="{Binding SaveApplicationCommand}" Margin="0,0,5,0">
            <Image Source="{Binding IsDarkMode, Converter={StaticResource ImageConverter}, ConverterParameter=save}" Height="25" Width="25" />
          </Button>
          <Button ToolTip="Run/Continue (F5)" Command="{Binding RunContinueApplicationCommand}" Margin="6,0,1,0">
            <Image Source="{Binding IsDarkMode, Converter={StaticResource ImageConverter}, ConverterParameter=run}" Height="25" Width="25" />
          </Button>
          <Button ToolTip="Pause/Break All (Ctrl+B)" Command="{Binding PauseApplicationCommand}" Margin="0,0,1,0">
            <Image Source="{Binding IsDarkMode, Converter={StaticResource ImageConverter}, ConverterParameter=pause}" Height="25" Width="25" />
          </Button>
          <Button ToolTip="Stop Debugger (Shift+F5)" Command="{Binding StopApplicationCommand}" Margin="0,0,1,0">
            <Image Source="{Binding IsDarkMode, Converter={StaticResource ImageConverter}, ConverterParameter=stop}" Height="25" Width="25" />
          </Button>
          <Button ToolTip="Execute Single Step (F10)" Command="{Binding ExecuteSingleStepCommand}">
            <Image Source="{Binding IsDarkMode, Converter={StaticResource ImageConverter}, ConverterParameter=step-into}" Height="25" Width="25" />
          </Button>
        </StackPanel>
      </Grid>

      <Grid Grid.Row="0" Grid.Column="2" Margin="5">
        <StackPanel Orientation="Horizontal">
          <Button ToolTip="New Source Code File (Ctrl+N)" Command="{Binding NewSourceCodeCommand}" Margin="0,0,1,0">
            <Image Source="{Binding IsDarkMode, Converter={StaticResource ImageConverter}, ConverterParameter=new}" Height="25" Width="25" />
          </Button>
          <Button ToolTip="Open Source Code File (Ctrl+O)" Command="{Binding LoadSourceCodeCommand}" Margin="0,0,1,0">
            <Image Source="{Binding IsDarkMode, Converter={StaticResource ImageConverter}, ConverterParameter=load}" Height="25" Width="25" />
          </Button>
          <Button ToolTip="Save Source Code File (Ctrl+S)" Command="{Binding SaveSourceCodeCommand}" Margin="0,0,5,0">
            <Image Source="{Binding IsDarkMode, Converter={StaticResource ImageConverter}, ConverterParameter=save}" Height="25" Width="25" />
          </Button>
          <Button ToolTip="Build Source Code (F6)" Command="{Binding BuildSourceCodeCommand}" Margin="6,0,1,0">
            <Image Source="{Binding IsDarkMode, Converter={StaticResource ImageConverter}, ConverterParameter=build}" Height="25" Width="25" />
          </Button>
          <Button ToolTip="Toggle Breakpoint (F9)" Command="{Binding ToggleBreakpointCommand}">
            <Image Source="{Binding IsDarkMode, Converter={StaticResource ImageConverter}, ConverterParameter=breakpoint}" Height="25" Width="25" />
          </Button>
        </StackPanel>
      </Grid>

      <chip8uiview:BindableAvalonEditor xmlns:avalonEdit="http://icsharpcode.net/sharpdevelop/avalonedit"
                                   Grid.Column="0"
                                   Grid.Row="1"
                                   x:Name="TextEditorBinary"
                                   FontFamily="Consolas"
                                   Background="{Binding EditorBackground}"
                                   Foreground="{Binding EditorForeground}"
                                   SyntaxHighlighting="CHIP-8"
                                   Margin="5"
                                   Padding="10"
                                   ShowLineNumbers="True"
                                   FontSize="10pt"
                                   Text="{Binding InstructionInMemory}">
        <chip8uiview:BindableAvalonEditor.Resources>
          <Style TargetType="ScrollViewer">
            <Setter Property="chip8uiview:SynchronisedScroll.Token" Value="{StaticResource scrollToken}" />
          </Style>
        </chip8uiview:BindableAvalonEditor.Resources>
      </chip8uiview:BindableAvalonEditor>

      <GridSplitter Grid.Column="1" Grid.Row="1" Grid.RowSpan="2" Width="5" HorizontalAlignment="Stretch" />

      <chip8uiview:BindableAvalonEditor xmlns:avalonEdit="http://icsharpcode.net/sharpdevelop/avalonedit"
                                   Grid.Column="2"
                                   Grid.Row="1"
                                   x:Name="TextEditorCode"
                                   FontFamily="Consolas"
                                   Background="{Binding EditorBackground}"
                                   Foreground="{Binding EditorForeground}"
                                   SyntaxHighlighting="CHIP-8"
                                   Margin="5"
                                   Padding="10"
                                   ShowLineNumbers="True"
                                   FontSize="10pt"
                                              Text="{Binding InstructionInCode}">
        <chip8uiview:BindableAvalonEditor.Resources>
          <Style TargetType="ScrollViewer">
            <Setter Property="chip8uiview:SynchronisedScroll.Token" Value="{StaticResource scrollToken}" />
          </Style>
        </chip8uiview:BindableAvalonEditor.Resources>
      </chip8uiview:BindableAvalonEditor>
    </Grid>

    <StatusBar Grid.ColumnSpan="2" Grid.Row="2" Padding="5">
      <StatusBarItem HorizontalAlignment="Right">
        <TextBlock Text="{Binding FpsIpsStats}" />
      </StatusBarItem>
    </StatusBar>
  </Grid>
</Window>
